---
applyTo: "**/*.ts,**/*.tsx,**/package.json"
---

# GitHub Copilot Security Instructions

## ðŸš¨ CRITICAL SECURITY ALERT: CVE-2025-66478 / CVE-2025-55182

**Severity: CVSS 10.0 (Critical) - Remote Code Execution**

A critical security vulnerability has been identified in React Server Components (RSC) that allows **unauthenticated remote code execution** through crafted HTTP requests to Server Function endpoints.

---

## âš™ï¸ MANDATORY PRE-FLIGHT CHECK

**BEFORE making ANY changes to `.ts`, `.tsx`, or `package.json` files, you MUST:**

1. **Locate and read `package.json`** in the project root (or nearest parent directory)
2. **Extract the versions** of: `next`, `react`, `react-dom`, `react-server-dom-webpack`, `react-server-dom-parcel`, `react-server-dom-turbopack`
3. **Compare against the vulnerable versions list below**
4. **Check for bypass conditions** (see "Bypass Options" section)
5. **Report findings to the user** before proceeding with ANY code changes

**This check is NON-NEGOTIABLE. Do not skip this step.**

---

## Vulnerable Package Versions

### Vulnerable React Packages:
- `react` versions 19.0.0, 19.1.0, 19.1.1, 19.2.0
- `react-server-dom-webpack` versions 19.0.0, 19.1.0, 19.1.1, 19.2.0
- `react-server-dom-parcel` versions 19.0.0, 19.1.0, 19.1.1, 19.2.0
- `react-server-dom-turbopack` versions 19.0.0, 19.1.0, 19.1.1, 19.2.0

### Vulnerable Next.js Versions:
- Next.js 15.x (any version before 15.0.5, 15.1.9, 15.2.6, 15.3.6, 15.4.8, 15.5.7)
- Next.js 16.x (any version before 16.0.7)
- Next.js 14.3.0-canary.77 and later canary releases

### Other Vulnerable Frameworks/Bundlers:
- react-router (with unstable RSC APIs)
- waku
- @parcel/rsc
- @vitejs/plugin-rsc
- rwsdk

---

## Safe Versions (Patched)

### Next.js Patched Versions:
- 15.0.5, 15.1.9, 15.2.6, 15.3.6, 15.4.8, 15.5.7, 16.0.7+

### React Patched Versions:
- 19.0.1, 19.1.2, 19.2.1+

### NOT Affected (Safe):
- Next.js 13.x (all versions)
- Next.js 14.x stable releases (before 14.3.0-canary.77)
- Applications using only Pages Router (not App Router)
- Applications using Edge Runtime
- Applications that do NOT use React Server Components
- Client-only React applications

---

## ðŸ›‘ If Vulnerable Versions Are Detected

### Default Behavior (No Bypass Active)

If vulnerable package versions are detected and NO bypass is active:

**STOP ALL DEVELOPMENT WORK AND ALERT THE USER with the following message:**

> âš ï¸ **CRITICAL SECURITY VULNERABILITY DETECTED** âš ï¸
> 
> This project is using **[package]@[version]** which is affected by **CVE-2025-66478**, a CVSS 10.0 remote code execution vulnerability.
> 
> **Development work cannot proceed until this is addressed.**
> 
> ### Immediate Actions Required:
> 
> 1. **Escalate** this to your Product Manager and Security Team immediately
> 2. **Run the security assessment prompt** to get a full remediation plan:
>    ```
>    /check-react-vulnerability-cve-2025-66478
>    ```
>    Or with auto-remediation:
>    ```
>    /check-react-vulnerability-cve-2025-66478 auto-resolve=TRUE
>    ```
> 3. **Upgrade** to a patched version (see remediation commands below)
> 
> ### If you need to proceed with development despite this vulnerability:
> 
> **Option 1 - Per-request bypass:** Include `bypass-vulnerability-scan=TRUE` in your prompt
> 
> **Option 2 - Session bypass:** Set environment variable:
> ```powershell
> $Env:REACT_VULNERABILITY_BYPASS = "TRUE"
> ```
> 
> âš ï¸ **Warning:** Bypassing this check means you are knowingly working in a vulnerable codebase. Ensure this vulnerability is tracked and scheduled for remediation.

---

## ðŸ”“ Bypass Options

### Option 1: Per-Request Bypass

Include `bypass-vulnerability-scan=TRUE` anywhere in your prompt to bypass the security block for that specific request only.

**Example:**
> "Change the button color to blue. bypass-vulnerability-scan=TRUE"

### Option 2: Environment Variable Bypass

Set the environment variable `REACT_VULNERABILITY_BYPASS` to `TRUE` to bypass the security block for all requests in the current session.

**PowerShell:**
```powershell
$Env:REACT_VULNERABILITY_BYPASS = "TRUE"
```

**Bash/Zsh:**
```bash
export REACT_VULNERABILITY_BYPASS=TRUE
```

**To remove the bypass:**
```powershell
Remove-Item Env:REACT_VULNERABILITY_BYPASS
```

---

## âš ï¸ Behavior When Bypass Is Active

**Even when a bypass is active, ALWAYS include this notice in your response:**

> âš ï¸ **SECURITY NOTICE:** This project uses **[package]@[version]** which is vulnerable to **CVE-2025-66478** (CVSS 10.0 - Remote Code Execution).
> 
> Proceeding with requested changes as vulnerability bypass is active.
> 
> **Reminder:** Run `/check-react-vulnerability-cve-2025-66478` to assess and remediate this vulnerability.

Then proceed with the user's requested task.

**This notice ensures:**
- Users are always aware they're working in a vulnerable codebase
- If switching projects, users will be notified if the new project is also vulnerable
- The vulnerability is never silently ignored

---

## Detection Logic (Pseudocode)

```
1. READ package.json from project
2. EXTRACT versions of: next, react, react-dom, react-server-dom-*
3. CHECK if any version matches vulnerable patterns
4. IF vulnerable:
   a. CHECK if user prompt contains "bypass-vulnerability-scan=TRUE"
   b. CHECK if environment variable REACT_VULNERABILITY_BYPASS = "TRUE"
   c. IF bypass active:
      - DISPLAY security notice (always)
      - PROCEED with requested task
   d. IF no bypass:
      - STOP all development work
      - DISPLAY full vulnerability alert
      - RECOMMEND running /check-react-vulnerability-cve-2025-66478
      - DO NOT make any code changes
5. IF not vulnerable:
   - PROCEED with requested task normally
```

---

## Remediation Commands

```bash
# For Next.js 15.0.x
npm install next@15.0.5

# For Next.js 15.1.x
npm install next@15.1.9

# For Next.js 15.2.x
npm install next@15.2.6

# For Next.js 15.3.x
npm install next@15.3.6

# For Next.js 15.4.x
npm install next@15.4.8

# For Next.js 15.5.x
npm install next@15.5.7

# For Next.js 16.0.x
npm install next@16.0.7

# For Next.js 14.3.0-canary.77+, downgrade to stable
npm install next@14

# For React packages directly
npm install react@latest react-dom@latest react-server-dom-webpack@latest
```

---

## Understanding the Vulnerability

**CWE-502: Deserialization of Untrusted Data**

The RSC protocol allows untrusted inputs to influence server-side execution behavior. An unauthenticated attacker can:
1. Craft malicious HTTP requests to ANY Server Function endpoint
2. Exploit the flaw in how React decodes/deserializes payloads
3. Achieve **remote code execution** on the server

Even if your app doesn't explicitly implement Server Functions, it may still be vulnerable if it supports React Server Components.

---

## Security Scanning Recommendations

Always recommend enabling:
1. **GitHub Dependabot** - Automatic security alerts
2. **GitHub Advanced Security (GHAS)** - Code scanning
3. **npm audit** - Regular dependency audits

---

## General React Server Component Security Guidelines

When developing with React Server Components:

1. **Validate ALL inputs** - Server Functions receive data from untrusted clients
2. **Use authentication/authorization** - Protect Server Function endpoints
3. **Keep dependencies updated** - Run `npm audit` regularly
4. **Monitor CVE databases** - Subscribe to security advisories
5. **Use allowlists over blocklists** - For any serialization/deserialization

---

*Last Updated: December 2025*
*Reference: https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components*