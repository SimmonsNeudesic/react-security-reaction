---
title: Check for React CVE-2025-66478 Vulnerability
description: Multi-phase security analysis and remediation workflow for CVE-2025-66478 / CVE-2025-55182 vulnerability in React Server Components
parameters:
  - name: auto-resolve
    description: Enable automated remediation and upgrade plan generation
    default: "FALSE"
  - name: audit-summary
    description: Generate a security audit summary report
    default: "TRUE"
  - name: report-path
    description: Folder path for audit findings and summary reports
    default: "/"
---

# React Server Components Security Assessment - CVE-2025-66478

This prompt performs a comprehensive multi-phase security assessment for the critical React Server Components vulnerability (CVE-2025-66478 / CVE-2025-55182).

**Configuration:**
- Auto-Resolve: `{{auto-resolve}}`
- Generate Audit Summary: `{{audit-summary}}`
- Report Path: `{{report-path}}`

---

## PHASE 1: Initial Repository Assessment

Analyze this repository for the CVE-2025-66478 / CVE-2025-55182 vulnerability.

### Assessment Checklist:

1. **Package Version Analysis:**
   - Read package.json and identify Next.js, React, and react-server-dom-* package versions
   - Check package-lock.json or yarn.lock for exact installed versions
   - Identify all React-related dependencies

2. **React Server Components Detection:**
   - Search for 'use server' directives in the codebase
   - Look for async server components
   - Check for server-only imports
   - Identify Server Actions and Server Functions

3. **Vulnerability Pattern Matching:**
   
   Check if any package versions match vulnerable patterns:
   
   **Next.js Vulnerable Versions:**
   - Next.js 15.x before 15.0.5, 15.1.9, 15.2.6, 15.3.6, 15.4.8, or 15.5.7
   - Next.js 16.x before 16.0.7
   - Next.js 14.3.0-canary.77 or later (canary builds)
   
   **React Vulnerable Versions:**
   - React 19.0.0
   - React 19.1.0, 19.1.1
   - React 19.2.0
   
   **react-server-dom-* Vulnerable Versions:**
   - react-server-dom-webpack 19.0.0 through 19.2.0
   - react-server-dom-parcel 19.0.0 through 19.2.0
   - react-server-dom-turbopack 19.0.0 through 19.2.0

### Output Requirements:

Generate a detailed assessment report with:

- **Current Package Versions:**
  - Next.js: [version]
  - React: [version]
  - React DOM: [version]
  - react-server-dom-*: [versions if present]

- **React Server Components Usage:**
  - Are RSC features in use? (YES/NO/UNCLEAR)
  - Number of files with 'use server' directives
  - List of Server Actions/Functions found

- **Vulnerability Status:** (VULNERABLE / SAFE / UNABLE TO DETERMINE)
  - Clear statement of current risk level
  - CVSS Score: 10.0 (Critical) if vulnerable
  - Attack Vector: Network, Authentication: None, User Interaction: None

- **Immediate Recommendations:**
  - Specific remediation commands if vulnerable
  - Priority level (CRITICAL/HIGH/MEDIUM/LOW)

**Save this assessment as:** `{{report-path}}/VULNERABILITY_ASSESSMENT.md`

---

## PHASE 2: Generate Upgrade Plan

**Execute this phase if PHASE 1 determined the repository is VULNERABLE.**

This repository uses vulnerable package versions. Generate a complete upgrade plan:

### 1. Target Versions

Determine the minimum safe versions based on current installation:

**Next.js Patched Versions:**
- If on 15.0.x â†’ upgrade to 15.0.5+
- If on 15.1.x â†’ upgrade to 15.1.9+
- If on 15.2.x â†’ upgrade to 15.2.6+
- If on 15.3.x â†’ upgrade to 15.3.6+
- If on 15.4.x â†’ upgrade to 15.4.8+
- If on 15.5.x â†’ upgrade to 15.5.7+
- If on 16.0.x â†’ upgrade to 16.0.7+
- If on 14.3.0-canary.77+ â†’ upgrade to stable 15.x

**React Patched Versions:**
- If on 19.0.0 â†’ upgrade to 19.0.1+
- If on 19.1.0 or 19.1.1 â†’ upgrade to 19.1.2+
- If on 19.2.0 â†’ upgrade to 19.2.1+

**react-server-dom-* Patched Versions:**
- Upgrade to latest stable release matching React version

### 2. Breaking Changes Analysis

Review the changelog between current and target versions:
- List any breaking changes that affect this codebase
- Identify deprecated APIs in use
- Note changed behavior that might impact functionality
- Document new required configurations

### 3. Code Impact Assessment

Search the codebase for patterns affected by the upgrade:
- Server Actions using vulnerable patterns
- Server Components with specific dependencies
- API routes that might need updates
- Configuration files requiring changes

### 4. Step-by-Step Upgrade Instructions

Provide exact commands and steps:

```bash
# Backup current state
git checkout -b security/cve-2025-66478-remediation

# Update packages (choose appropriate package manager)
npm install next@[TARGET_VERSION] --save
npm install react@[TARGET_VERSION] react-dom@[TARGET_VERSION] --save
# Add other package updates as needed

# Update lock file
npm install

# Verify installation
npm list next react react-dom
```

### 5. Configuration Changes

List any required changes to:
- next.config.js
- tsconfig.json
- package.json scripts
- Environment variables
- Other configuration files

### 6. Verification Steps

Define how to verify the patch:
- Build verification: `npm run build`
- Test execution: `npm test`
- Manual security checks
- Package audit: `npm audit`

### 7. Rollback Plan

Document rollback procedure:
```bash
# If upgrade fails
git checkout [original-branch]
git branch -D security/cve-2025-66478-remediation
npm install  # Restore original packages
```

**Save this upgrade plan as:** `{{report-path}}/UPGRADE_PLAN.md`

---

## PHASE 3: Automated Remediation (Optional)

**Execute this phase only if `{{auto-resolve}}` = TRUE**

### Task: Remediate CVE-2025-66478 Security Vulnerability

#### Context
CVE-2025-66478 is a CVSS 10.0 critical vulnerability in React Server Components that allows unauthenticated remote code execution through prototype pollution in RSC payloads.

#### Automated Remediation Steps

1. **Scan and Confirm Vulnerability:**
   - Re-verify current package versions
   - Confirm vulnerable patterns
   - Document current state

2. **Update All Affected Packages:**
   - Next.js: upgrade within the current minor version to patched release
   - React: upgrade to 19.0.1, 19.1.2, or 19.2.1+
   - react-server-dom-*: upgrade to latest stable
   - Run: `npm install` or `yarn install`

3. **Ensure Application Builds:**
   - Run: `npm install`
   - Run: `npm run build`
   - Capture and document any build errors
   - Fix build errors if possible

4. **Run Existing Tests:**
   - Run: `npm test` (if tests exist)
   - Document any test failures
   - Attempt to fix test failures related to upgrades

5. **Update Upgrade Plan Document:**
   - Mark completed steps in `{{report-path}}/UPGRADE_PLAN.md`
   - Document any issues encountered
   - Note any manual steps still required

6. **Verification:**
   - Run: `npm audit`
   - Run: `npm list next react react-dom`
   - Confirm all versions are at or above patched releases
   - Document verification results

#### Constraints
- Do not change application functionality
- Maintain backward compatibility where possible
- Document all changes clearly in upgrade plan
- If automated fixes fail, document the failure and required manual steps

#### Output
- Updated package.json and package-lock.json/yarn.lock
- Updated `{{report-path}}/UPGRADE_PLAN.md` with progress tracking
- Build and test results documented

**If automation succeeds:** Prepare details for pull request creation (Phase 5)

**If automation fails:** Document failure points and provide manual remediation guidance

---

## PHASE 4: Security Audit Summary

**Execute this phase if `{{audit-summary}}` = TRUE**

Generate a comprehensive security audit summary for stakeholders regarding CVE-2025-66478.

### Report Structure:

#### 1. Executive Summary
Provide 2-3 sentences for non-technical stakeholders explaining:
- What was found
- What risk it poses
- What action is being taken

#### 2. Technical Details

**Vulnerability Information:**
- CVE ID: CVE-2025-66478 / CVE-2025-55182
- CVSS Score: 10.0 (Critical)
- Attack Vector: Network
- Authentication Required: None
- User Interaction: None

**Affected Components:**
- List all affected packages and versions found
- Indicate whether RSC features are actively in use
- Describe the attack surface

#### 3. Risk Assessment

**Current Exposure Level:**
- CRITICAL: Actively using vulnerable RSC features
- HIGH: Using vulnerable packages but RSC usage unclear
- MEDIUM: Vulnerable packages installed but no RSC features detected
- LOW: Packages present but not in use

**Potential Impact:**
- Remote Code Execution (RCE)
- Complete system compromise
- Data breach potential
- Service disruption

**Urgency Rating:**
- IMMEDIATE: Patch within 24 hours
- URGENT: Patch within 72 hours
- HIGH: Patch within 1 week
- MEDIUM: Patch within 2 weeks

#### 4. Remediation Status

**Changes Already Made:**
- List completed remediation steps (if any from Phase 3)
- Note successful upgrades

**Remaining Work:**
- List pending tasks
- Note any blockers
- Identify manual steps required

**Estimated Effort:**
- Time to complete remaining work
- Resource requirements
- Testing requirements

#### 5. Recommendations

**Immediate Actions:**
- Apply security patches
- Verify patch effectiveness
- Test critical functionality

**Follow-up Actions:**
- Comprehensive testing
- Deployment planning
- Stakeholder communication

**Preventive Measures:**
- Dependency monitoring
- Security scanning in CI/CD
- Regular security audits
- Update policies

#### 6. References
- CVE-2025-66478: https://nvd.nist.gov/vuln/detail/CVE-2025-66478
- CVE-2025-55182: https://nvd.nist.gov/vuln/detail/CVE-2025-55182
- React Security Advisory
- Next.js Security Advisory

**Save this audit summary as:** `{{report-path}}/SECURITY_AUDIT_SUMMARY.md`

---

## PHASE 5: Issue Creation and Documentation

### GitHub Issue Creation

Attempt to create a high-priority GitHub issue with the following details:

**Issue Title:**
```
[CRITICAL SECURITY] CVE-2025-66478: React Server Components RCE Vulnerability
```

**Issue Labels:**
- security
- critical
- vulnerability
- priority: high

**Issue Body:**
```markdown
## ðŸš¨ Critical Security Vulnerability Detected

**CVE ID:** CVE-2025-66478 / CVE-2025-55182
**CVSS Score:** 10.0 (Critical)
**Severity:** CRITICAL

### Summary
A critical vulnerability has been detected in this repository's React/Next.js dependencies that allows for unauthenticated remote code execution through React Server Components.

### Affected Packages
[List from Phase 1 assessment]

### Current Status
[VULNERABLE / PATCHING IN PROGRESS / PATCHED]

### Required Action
Immediate upgrade of the following packages required:
[List specific upgrade commands]

### Documentation
- Assessment Report: `{{report-path}}/VULNERABILITY_ASSESSMENT.md`
- Upgrade Plan: `{{report-path}}/UPGRADE_PLAN.md`
{{#if audit-summary}}
- Audit Summary: `{{report-path}}/SECURITY_AUDIT_SUMMARY.md`
{{/if}}

### Timeline
- **Detection Date:** [Current Date]
- **Target Resolution:** Within 24-72 hours
- **Assigned To:** [Auto-assign to repo maintainers if possible]

### References
- https://nvd.nist.gov/vuln/detail/CVE-2025-66478
- https://nvd.nist.gov/vuln/detail/CVE-2025-55182

---
*This issue was automatically generated by security scanning workflow.*
```

### Fallback: Vulnerability Notice File

**If GitHub issue creation fails** (issues not enabled, permissions insufficient, etc.):

Create a fallback vulnerability notice file that can be manually used to create an issue.

**Save as:** `{{report-path}}/VULNERABILITY_NOTICE.md`

**Content:**
```markdown
# ðŸš¨ CRITICAL SECURITY VULNERABILITY NOTICE

> **ACTION REQUIRED:** This repository contains a critical security vulnerability that must be addressed immediately.

---

## Vulnerability Details

**CVE ID:** CVE-2025-66478 / CVE-2025-55182
**CVSS Score:** 10.0 (Critical)
**Published:** December 2025
**Severity Level:** CRITICAL

## What This Means

This repository uses vulnerable versions of React/Next.js packages that contain a critical remote code execution vulnerability in React Server Components. An attacker can potentially:
- Execute arbitrary code on the server
- Gain unauthorized access to system resources
- Compromise sensitive data
- Disrupt service availability

**No authentication or user interaction is required for exploitation.**

## Affected Components

[Insert findings from Phase 1]

## Immediate Actions Required

1. **Review Assessment:** See `{{report-path}}/VULNERABILITY_ASSESSMENT.md`
2. **Follow Upgrade Plan:** See `{{report-path}}/UPGRADE_PLAN.md`
{{#if audit-summary}}
3. **Review Audit Summary:** See `{{report-path}}/SECURITY_AUDIT_SUMMARY.md`
{{/if}}
4. **Apply Patches:** Upgrade to patched versions immediately
5. **Verify Fix:** Run security verification steps
6. **Deploy:** Push patched versions to all environments

## Timeline

- **Detection Date:** [Current Date]
- **Recommended Resolution Time:** 24-72 hours
- **Priority:** CRITICAL - Highest Priority

## Resources

- [CVE-2025-66478 Details](https://nvd.nist.gov/vuln/detail/CVE-2025-66478)
- [CVE-2025-55182 Details](https://nvd.nist.gov/vuln/detail/CVE-2025-55182)
- React Security Advisory
- Next.js Security Advisory

## Questions or Concerns?

Contact your security team or repository maintainers immediately.

---

**âš ï¸ Please create a GitHub issue with this information if issues are enabled, or escalate through your organization's security channels immediately.**

*Generated by automated security scanning - [Date/Time]*
```

**User Notification:**

If issue creation fails, inform the user:
```
âš ï¸ Unable to create GitHub issue automatically. This may be because:
- Issues are not enabled for this repository
- Insufficient permissions
- API rate limits

A vulnerability notice has been created at: {{report-path}}/VULNERABILITY_NOTICE.md

Please manually create a high-priority issue using this notice, or share it with repository maintainers immediately.
```

---

## PHASE 6: Post-Remediation Verification

**Execute this phase after remediation attempts (automatic or manual).**

Verify that CVE-2025-66478 has been properly remediated in this repository.

### Verification Checklist:

#### 1. Package Verification
Run the following commands and document output:

```bash
# List installed versions
npm list next react react-dom react-server-dom-webpack

# Verify no vulnerable versions remain
npm audit

# Check for outdated packages
npm outdated
```

**Expected Result:** All versions at or above patched releases

#### 2. Security Audit
```bash
# Run full security audit
npm audit --production

# Generate audit report
npm audit --json > {{report-path}}/npm-audit-results.json
```

**Expected Result:** No high or critical vulnerabilities related to CVE-2025-66478

#### 3. Build Verification
```bash
# Clean build
rm -rf .next node_modules/.cache

# Fresh build
npm run build
```

**Expected Result:**
- Build completes successfully
- No new warnings or errors
- Application starts correctly

#### 4. Functionality Check

**Server Actions/Functions Review:**
- List all files with 'use server' directive
- Verify syntax correctness
- Confirm no runtime errors in Server Actions
- Test critical Server Actions if possible

**Expected Result:** All Server Components and Actions function correctly

#### 5. Documentation Update

Update all documentation files:
- Mark `{{report-path}}/UPGRADE_PLAN.md` as COMPLETED
- Add verification results to `{{report-path}}/VULNERABILITY_ASSESSMENT.md`
- Update `{{report-path}}/SECURITY_AUDIT_SUMMARY.md` with final status
- Close or update GitHub issue with resolution confirmation

### Final Verification Report

Generate a final report with:

#### Summary
- âœ… Vulnerability Status: REMEDIATED / PARTIALLY REMEDIATED / FAILED
- âœ… All Packages Updated: YES / NO
- âœ… Build Successful: YES / NO
- âœ… Tests Passing: YES / NO / N/A
- âœ… No Remaining Vulnerabilities: YES / NO

#### Package Verification Results
```
Package          | Before    | After     | Status
-----------------|-----------|-----------|--------
next             | [version] | [version] | âœ… SAFE
react            | [version] | [version] | âœ… SAFE
react-dom        | [version] | [version] | âœ… SAFE
react-server-dom | [version] | [version] | âœ… SAFE
```

#### Remaining Issues or Concerns
- List any unresolved issues
- Note any warnings or concerns
- Document any required manual steps

#### Recommendations for Ongoing Security

1. **Dependency Monitoring:**
   - Implement automated dependency scanning
   - Set up GitHub Dependabot alerts
   - Subscribe to security advisories

2. **Update Policies:**
   - Establish regular update schedule
   - Define security patch SLAs
   - Document update procedures

3. **Testing:**
   - Maintain comprehensive test suite
   - Include security testing
   - Automate verification

4. **CI/CD Integration:**
   - Add security scanning to pipeline
   - Fail builds on high/critical vulnerabilities
   - Automate patch verification

**Save this verification report as:** `{{report-path}}/VERIFICATION_REPORT.md`

---

## Workflow Summary

This prompt executes the following workflow:

1. **PHASE 1** (Always): Assess repository for vulnerability
2. **PHASE 2** (If vulnerable): Generate detailed upgrade plan
3. **PHASE 3** (If `{{auto-resolve}}` = TRUE): Attempt automated remediation
4. **PHASE 4** (If `{{audit-summary}}` = TRUE): Generate stakeholder audit summary
5. **PHASE 5** (Always): Create GitHub issue or vulnerability notice
6. **PHASE 6** (After remediation): Verify patch effectiveness

### Output Files

All reports will be saved to: `{{report-path}}/`

Expected files:
- `VULNERABILITY_ASSESSMENT.md` (Phase 1)
- `UPGRADE_PLAN.md` (Phase 2, updated in Phase 3)
- `SECURITY_AUDIT_SUMMARY.md` (Phase 4, if enabled)
- `VULNERABILITY_NOTICE.md` (Phase 5, if issue creation fails)
- `VERIFICATION_REPORT.md` (Phase 6)
- `npm-audit-results.json` (Phase 6)

### Usage Notes

- **First Run:** Start with default parameters to assess without auto-remediation
- **Automated Mode:** Set `{{auto-resolve}}` = TRUE only when ready for automated fixes
- **Reporting:** Keep `{{audit-summary}}` = TRUE for comprehensive documentation
- **Custom Paths:** Set `{{report-path}}` to organize reports (e.g., `/docs/security`)

---

*Developed by Neudesic Security Response Team - December 2025*
*CVE-2025-66478 Multi-Phase Security Assessment Workflow v1.0*
